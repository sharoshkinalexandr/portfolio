<!doctype html>
<html lang="ru" data-theme="dark">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Шарошкин Александр Сергеевич — Маркетолог-перформанс</title>
<meta name="description" content="Перформанс-маркетинг, лиды, сквозная аналитика, CRM. Кейсы: RICHTONE, Human&Business, БТК, М131." />
<style>
  /* ===== ТЕМЫ ===== */
  :root{
    --bg:#0f1220; --card:#171a2b; --muted:#9aa3b2; --text:#e8ecf1;
    --acc:#6ee7b7; --acc2:#60a5fa; --acc3:#a78bfa;
    --grid:rgba(255,255,255,.08); --axis:rgba(255,255,255,.28); --tick:var(--text);
    --btn-bg:rgba(255,255,255,.06); --chip-bg:rgba(96,165,250,.08); --border:rgba(255,255,255,.06);
    --shadow:0 10px 30px rgba(0,0,0,.25);
    --grad:linear-gradient(90deg,var(--acc2),var(--acc));
    --gradOverlay:linear-gradient(180deg,
                      color-mix(in oklab,var(--acc) 24%, transparent),
                      color-mix(in oklab,var(--acc2) 24%, transparent));
    --tick-size:14px;
  }
  [data-theme="light"]{
    --bg:#f7f9fc; --card:#ffffff; --muted:#586174; --text:#0f172a;
    --acc:#0ea5e9; --acc2:#6366f1; --acc3:#22c55e;
    --grid:rgba(15,23,42,.08); --axis:rgba(15,23,42,.22); --tick:var(--text);
    --btn-bg:#eef2ff; --chip-bg:#e0f2fe; --border:#e5e7eb;
    --shadow:0 8px 24px rgba(15,23,42,.08);
    --grad:linear-gradient(90deg,var(--acc2),var(--acc));
    --gradOverlay:linear-gradient(180deg,
                      color-mix(in oklab,var(--acc) 22%, transparent),
                      color-mix(in oklab,var(--acc2) 22%, transparent));
    --tick-size:14px;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
    color:var(--text);
    background:radial-gradient(1200px 600px at 80% -10%, rgba(27,30,51,.6) 0%, transparent 60%),var(--bg);
    line-height:1.6;
    overflow-x:hidden;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }
  a{color:var(--acc2);text-decoration:none}
  .wrap{max-width:1100px;margin:0 auto;padding:24px}
  .h1{font-size:clamp(28px,5.2vw,42px);line-height:1.12;margin:0 0 12px;font-weight:800;
      background:linear-gradient(90deg,var(--acc),var(--acc2),var(--acc3));-webkit-background-clip:text;background-clip:text;color:transparent}
  h2{margin:0 0 16px;font-size:clamp(22px,3.2vw,28px)}
  h3{margin:0 0 8px;font-size:clamp(16px,2.5vw,18px)}

  /* ===== ШАПКА + моб.меню ===== */
  header{position:sticky;top:0;z-index:40;background:rgba(15,18,32,.55);backdrop-filter:blur(10px);border-bottom:1px solid var(--border)}
  .nav{display:flex;align-items:center;justify-content:space-between;gap:12px;min-height:56px}
  .brand{display:flex;align-items:center;gap:10px}
  .logo{width:32px;height:32px;border-radius:8px;background:conic-gradient(from 180deg,var(--acc),var(--acc2),var(--acc3),var(--acc));box-shadow:0 0 30px rgba(110,231,183,.25);animation:spin 8s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}

  nav.primary{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  nav.primary a{color:var(--text);font-weight:600;padding:8px 10px;border-radius:8px}
  nav.primary a:hover{background:var(--btn-bg)}
  .toggle,.menu{
    padding:10px 12px;border-radius:10px;border:1px solid var(--border);
    background:var(--card);display:inline-flex;align-items:center;gap:8px;cursor:pointer
  }
  .toggle svg,.menu svg{width:18px;height:18px}
  .menu{display:none}

  /* Оверлей без blur (не мутнит всё), кликабельно меню поверх */
  .scrim{
    position:fixed;inset:0;background:rgba(0,0,0,.35);
    opacity:0;pointer-events:none;transition:opacity .2s ease;z-index:1000
  }
  body.menu-open .scrim{opacity:1;pointer-events:auto}
  body.menu-open{overflow:hidden}

  /* ===== БАЗОВЫЕ БЛОКИ ===== */
  .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:24px;box-shadow:var(--shadow);transform:translateY(10px);opacity:0;transition:all .6s ease}
  .reveal{transform:none!important;opacity:1!important}
  .section{padding:34px 0}

  .hero{display:grid;grid-template-columns:1.2fr .8fr;gap:28px;padding:48px 0}
  .lead{color:var(--muted);margin:0 0 18px}
  .chips{display:flex;flex-wrap:wrap;gap:10px;margin:14px 0 22px}
  .chip{padding:6px 10px;border-radius:999px;border:1px solid var(--border);color:color-mix(in oklab,var(--acc2) 85%, var(--text));background:var(--chip-bg)}
  .btns{display:flex;gap:12px;flex-wrap:wrap}

  /* ===== КНОПКИ (fw=600) ===== */
  .btn,.sbtn{
    padding:14px 18px;border-radius:12px;border:none;font-weight:600;cursor:pointer;
    display:inline-flex;align-items:center;gap:10px;background:var(--grad);color:#0b1022;
    transition:transform .15s ease, filter .15s ease; touch-action:manipulation; -webkit-tap-highlight-color:transparent;
  }
  .btn:hover,.sbtn:hover{transform:translateY(-2px);filter:brightness(1.06)}
  .sbtn svg{width:20px;height:20px}
  .muted{color:var(--muted)}

  /* ОБО МНЕ */
  .about{display:grid;grid-template-columns:180px 1fr;gap:22px;align-items:start}
  .avatar{width:160px;height:160px;border-radius:50%;object-fit:cover;box-shadow:var(--shadow)}

  /* КЕЙСЫ */
  details{border:1px solid var(--border);background:color-mix(in oklab,var(--card) 96%, transparent 4%);border-radius:14px;transition:all .25s ease;margin-bottom:12px}
  summary{list-style:none;padding:16px 18px;cursor:pointer;font-weight:700;color:var(--text);display:flex;align-items:center;gap:10px}
  summary img{height:26px;border-radius:6px;border:none;background:transparent}
  summary::-webkit-details-marker{display:none}
  details[open]{box-shadow:var(--shadow)}
  .case-body{padding:0 18px 18px;color:var(--text);border-top:1px dashed var(--border)}
  .shot{margin-top:10px}
  .shot a{display:inline-block;border-radius:12px;overflow:hidden;position:relative}
  .shot img{width:100%;display:block}
  .shot a::after{content:"";position:absolute;inset:0;background:var(--gradOverlay);opacity:.22;transition:opacity .25s ease}
  .shot a:hover::after{opacity:.35}

  /* Галерея */
  .logos{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
  .logos a{display:block;border-radius:12px;overflow:hidden;position:relative;border:1px solid var(--border)}
  .logos a img{width:100%;aspect-ratio:16/10;object-fit:cover;display:block}
  .logos a::after{content:"";position:absolute;inset:0;background:var(--gradOverlay);opacity:.22;transition:opacity .25s ease}
  .logos a:hover::after{opacity:.35}
  a:has(> img){position:relative;display:inline-block;border-radius:12px;overflow:hidden}
  a:has(> img)::after{content:"";position:absolute;inset:0;background:var(--gradOverlay);opacity:.18;transition:opacity .25s ease}
  a:has(> img):hover::after{opacity:.34}

  /* ГРАФИКИ */
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:18px}
  .chart{background:color-mix(in oklab,var(--card) 98%, transparent 2%);border:1px solid var(--border);border-radius:12px;padding:12px;position:relative}
  .chart svg{overflow:visible} /* важное: подписи за рамками видны */
  .chart text{font-variant-numeric:tabular-nums;letter-spacing:.2px}
  .tooltip{position:absolute;pointer-events:none;background:color-mix(in oklab,var(--bg) 94%, #000 6%);color:var(--text);border:1px solid var(--axis);border-radius:8px;padding:6px 8px;font-size:12px;box-shadow:var(--shadow);display:none}

  /* ===== АДАПТИВ ===== */
  @media (max-width:1024px){
    .wrap{padding:20px}
    .hero{gap:20px}
  }
  @media (max-width:900px){
    .logos{grid-template-columns:repeat(3,1fr)}
  }
  @media (max-width:768px){
    .wrap{padding:18px}
    .hero{grid-template-columns:1fr;padding:28px 0}
    .about{grid-template-columns:1fr;gap:16px}
    .avatar{width:132px;height:132px}
    .grid-2{grid-template-columns:1fr}

    /* меню поверх скрима, кликабельно */
    .menu{display:inline-flex}
    nav.primary{
      position:fixed; top:64px; left:12px; right:12px; bottom:auto;
      max-height:calc(100dvh - 80px); overflow:auto; z-index:1101;  /* было 1001 */
      background:var(--card); border:1px solid var(--border);
      border-radius:14px; box-shadow:var(--shadow); padding:10px;
      display:none; flex-direction:column; gap:6px;
    }
    body.menu-open nav.primary{display:flex}
    nav.primary a{padding:12px 14px}
    .btn,.sbtn{width:100%}
  }
  @media (max-width:640px){
    .logos{grid-template-columns:repeat(2,1fr)}
    :root{--tick-size:12px}
  }
  @media (max-width:380px){
    .logos{grid-template-columns:1fr}
  }
  @media (prefers-reduced-motion:reduce){
    *{animation:none !important; transition:none !important}
  }
</style>
</head>
<body>
<header>
  <div class="wrap nav">
    <div class="brand">
      <button class="menu" id="menuToggle" aria-label="Меню" aria-expanded="false">
        <svg viewBox="0 0 24 24" fill="none"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>
      <div class="logo" aria-hidden="true"></div>
      <strong>Шарошкин Александр Сергеевич — маркетолог</strong>
    </div>
    <nav class="primary" id="primaryNav">
      <a href="#about" onclick="closeMenu()">Обо мне</a>
      <a href="#cases" onclick="closeMenu()">Кейсы</a>
      <a href="#charts" onclick="closeMenu()">Графики</a>
      <a href="#projects" onclick="closeMenu()">Проекты</a>
      <a href="#contacts" onclick="closeMenu()">Контакты</a>
    </nav>
    <button id="themeToggle" class="toggle" aria-pressed="false" title="Переключить тему">
      <svg id="iconSun" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/><path d="M12 2v2M12 20v2M4 12H2m20 0h-2M5 5 3.6 3.6M20.4 20.4 19 19M19 5l1.4-1.4M3.6 20.4 5 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      <svg id="iconMoon" viewBox="0 0 24 24" fill="none" style="display:none"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2"/></svg>
    </button>
  </div>
</header>
<!-- скрим без blur -->
<div id="scrim" class="scrim"></div>

<main class="wrap">
  <!-- HERO -->
  <section class="hero">
    <div class="card">
      <h1 class="h1">Запускаю рекламу, которая приводит <span style="background:linear-gradient(90deg,var(--acc),var(--acc2));-webkit-background-clip:text;background-clip:text;color:transparent">целевых клиентов</span></h1>
      <p class="lead">Перформанс-маркетинг, аналитика и автоматизация. США, Канада, MENA, Восточная Европа. Результат: рост лидов, снижение CPL, прибыль по каналам.</p>
      <div class="chips">
        <span class="chip">Google / Meta / Яндекс</span>
        <span class="chip">Сквозная аналитика</span>
        <span class="chip">CRM и автоматизация</span>
        <span class="chip">RU / EN / 中文</span>
      </div>
      <div class="btns">
        <a class="btn" href="#cases">Смотреть кейсы</a>
        <a class="btn" href="#contacts">Обсудить проект</a>
      </div>
    </div>
    <div class="card">
      <h3>Коротко</h3>
      <ul>
        <li>RICHTONE — CPL ↓ <strong>35%</strong>, <strong>1150+</strong> заявок за 3 мес., ROI 300%+.</li>
        <li>Human&Business — бонусная система и ЛК: активность +45%, повторы +30%.</li>
        <li>БТК — стратегия и медиапланы: рост спроса +22% за квартал.</li>
      </ul>
      <p class="muted">Связываю рекламу, сайт и CRM, повышаю долю «деловых» лидов и маржу.</p>
    </div>
  </section>

  <!-- ОБО МНЕ -->
  <section id="about" class="section">
    <h2>Обо мне</h2>
    <div class="card about">
      <img class="avatar" src="img/photo.jpg" alt="Шарошкин Александр Сергеевич" />
      <div>
        <p><strong>Шарошкин Александр Сергеевич</strong> — маркетолог, отвечаю за поток заявок и прибыльность рекламы. Запускаю кампании в поиске и соцсетях для США, Канады, стран Персидского залива и Восточной Европы. Тестирую объявления и страницы, распределяю бюджеты по городам и времени.</p>
        <p>Собираю данные из рекламы, сайта и CRM в единый отчёт, считаю CPL/CAC/ROI, отслеживаю отклонения и быстро исправляю. Повышаю долю «деловых» лидов (формы, автоответы, квалификация), связываю письма/мессенджеры с рекламой, автоматизирую рутину.</p>
      </div>
    </div>
  </section>

  <!-- КЕЙСЫ -->
  <section id="cases" class="section">
    <h2>Кейсы (раскрываются по клику)</h2>

    <details class="card">
      <summary><img src="img/richtone-logo.png" alt="RICHTONE"> RICHTONE — международные рынки</summary>
      <div class="case-body">
        <p><strong>Цель:</strong> больше заявок и ниже CPL в США, Канаде, MENA, Восточной Европе.</p>
        <p><strong>Действия:</strong> Google/Meta Ads, распределение бюджетов, A/B-тесты креативов/лендингов, сквозная аналитика (сайт+CRM), автоответы, формы, квалификация лидов, UTM/скрипты.</p>
        <p><strong>Результат:</strong> CPL −35% (с 650 ₽ до 420 ₽), <strong>1150+ заявок</strong> за 3 мес., лид→сделка до 18%, ROMI 300%+.</p>
        <div class="shot"><a href="https://gzrichtone.com/ru/" target="_blank" rel="noopener"><img src="img/richtone.png" alt="Сайт RICHTONE"></a></div>
      </div>
    </details>

    <details class="card">
      <summary><img src="img/hb-logo.png" alt="Human&Business"> Human&Business — бонусная система</summary>
      <div class="case-body">
        <p><strong>Цель:</strong> рост удержания и повторных покупок.</p>
        <p><strong>Действия:</strong> координация SMM/трейд/дизайна/перфоманса, постановка задач и контроль подрядчиков, медиапланы, креативы, запуск ЛК.</p>
        <p><strong>Результат:</strong> активность +45% за 2 мес., повторы +30%.</p>
        <div class="shot"><a href="https://h-b.group/" target="_blank" rel="noopener"><img src="img/karmy.png" alt="Karmy / Human&Business"></a></div>
      </div>
    </details>

    <details class="card">
      <summary><img src="img/btk-logo.png" alt="БТК"> БТК — стратегия и исследования</summary>
      <div class="case-body">
        <p><strong>Действия:</strong> конкурентный анализ, фокус-группы, позиционирование, стратегия и медиапланы, PR.</p>
        <p><strong>Итог:</strong> 3 прибыльных направления, рост спроса +22%/кв.</p>
        <div class="shot"><a href="https://mari-roberto.lpmotortest.com/" target="_blank" rel="noopener"><img src="img/mariroberto.png" alt="Mariroberto — мебель из экоротанга"></a></div>
      </div>
    </details>

    <details class="card">
      <summary><img src="img/m131-logo.png" alt="М131"> ГК «М131» — розница и спрос</summary>
      <div class="case-body">
        <p><strong>Действия:</strong> отчётность по акциям, анализ эффективности, рекомендации по росту спроса, медиапланы, фокус-группы, мониторинг конкурентов.</p>
        <p><strong>Итог:</strong> устойчивый рост обращений и узнаваемости.</p>
        <div class="shot"><a href="https://shop-idea.ru/" target="_blank" rel="noopener"><img src="img/stroideya.png" alt="Стройидея / М131"></a></div>
      </div>
    </details>
  </section>

  <!-- ГРАФИКИ -->
  <section id="charts" class="section">
    <h2>Графики (реалистичные метрики за 6 месяцев)</h2>
    <div class="grid-2">
      <div class="card chart">
        <h3>Заявки по месяцам</h3>
        <div class="tooltip" id="tt-leads"></div>
        <svg id="leadsChart" width="100%" height="240" viewBox="0 0 380 240"></svg>
      </div>
      <div class="card chart">
        <h3>CPL по месяцам (руб.)</h3>
        <div class="tooltip" id="tt-cpl"></div>
        <svg id="cplChart" width="100%" height="240" viewBox="0 0 380 240"></svg>
      </div>
      <div class="card chart">
        <h3>ROI (x)</h3>
        <div class="tooltip" id="tt-roi"></div>
        <svg id="roiChart" width="100%" height="240" viewBox="0 0 380 240"></svg>
      </div>
      <div class="card chart">
        <h3>Конверсия лид→сделка (%)</h3>
        <div class="tooltip" id="tt-cr"></div>
        <svg id="crChart" width="100%" height="240" viewBox="0 0 380 240"></svg>
      </div>
    </div>
  </section>

  <!-- ПРОЕКТЫ -->
  <section id="projects" class="section">
    <h2>Проекты и сайты</h2>
    <div class="logos">
      <a href="https://gzrichtone.com/ru/" target="_blank" rel="noopener"><img src="img/richtone.png" alt="RICHTONE сайт"></a>
      <a href="https://h-b.group/" target="_blank" rel="noopener"><img src="img/karmy.png" alt="Karmy / Human&Business"></a>
      <a href="https://mari-roberto.lpmotortest.com/" target="_blank" rel="noopener"><img src="img/mariroberto.png" alt="Mariroberto / БТК"></a>
      <a href="https://shop-idea.ru/" target="_blank" rel="noopener"><img src="img/stroideya.png" alt="Стройидея / М131"></a>
    </div>
  </section>

  <!-- КОНТАКТЫ -->
  <section id="contacts" class="section">
    <h2>Контакты</h2>
    <div class="card">
      <p>Почта: <a href="mailto:sharoshkinalexandr@gmail.com">sharoshkinalexandr@gmail.com</a></p>
      <div class="btns" style="margin-top:10px">
        <a class="sbtn" href="https://t.me/Sharoshkin99" target="_blank" rel="noopener">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M9.6 15.6l-.3 4.3c.4 0 .6-.2.9-.4l2.1-2 4.3 3.1c.8.4 1.4.2 1.6-.7L22.9 4c.3-1-.4-1.5-1.2-1.2L2.2 10.1c-1 .4-1 1 0 1.3l4.4 1.3L18.9 6c.5-.3.9-.1.5.2l-9.8 9.4z"/></svg>
          Telegram
        </a>
        <a class="sbtn" href="https://wa.me/79003006324" target="_blank" rel="noopener">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 1.8A10.2 10.2 0 003.1 18.4L2 22l3.7-1A10.2 10.2 0 1012 1.8zm0 18.7a8.5 8.5 0 01-4.3-1.2l-.3-.2-2.5.6.7-2.4-.2-.3A8.5 8.5 0 1112 20.5zm4.7-6.2c-.3-.2-1.8-.9-2-1-.3-.1-.5-.2-.7.2-.2.2-.8 1-.9 1.1-.1.2-.3.2-.6 0-.3-.2-1.1-.4-2.1-1.4-.8-.7-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6l.5-.6c.1-.2.1-.3.2-.5 0-.2 0-.4 0-.6 0-.2-.7-1.7-1-2.4-.2-.6-.5-.5-.7-.5h-.6c-.2 0-.6.1-.9.4-.3.3-1.1 1-1.1 2.5s1.2 2.9 1.4 3.1c.2.3 2.3 3.5 5.4 4.8.7.3 1.3.5 1.8.7.8.2 1.6.2 2.2.1.7-.1 2.2-.9 2.5-1.8.3-1 0-1.7-.3-1.9z"/></svg>
          WhatsApp
        </a>
        <a class="sbtn" href="weixin://dl/chat?bombermanmarketolog">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M10.2 4.3c-3.8 0-6.9 2.5-6.9 5.7 0 1.9 1.1 3.6 2.9 4.6l-.7 2.4 2.5-1.3c.7.2 1.4.3 2.1.3 3.8 0 6.9-2.5 6.9-5.7s-3.1-6-6.8-6zm-2.8 6.1c-.4 0-.8-.3-.8-.7s.4-.7.8-.7.7.3.7.7-.3.7-.7.7zm3.9 0c-.4 0-.8-.3-.8-.7s.4-.7.8-.7.7.3.7.7-.3.7-.7.7z"/></svg>
          WeChat
        </a>
      </div>
      <div style="margin-top:20px">
        <a class="btn" href="resume.pdf" download>Скачать резюме (PDF)</a>
      </div>
    </div>
  </section>
</main>

<!-- ====== СКРИПТЫ ====== -->
<script>
/* Тема и перерисовка графиков */
(function(){
  const saved=localStorage.getItem('theme');
  if(saved) document.documentElement.setAttribute('data-theme', saved);
  const isLight=document.documentElement.getAttribute('data-theme')==='light';
  document.getElementById('iconSun').style.display=isLight?'none':'block';
  document.getElementById('iconMoon').style.display=isLight?'block':'none';
})();

document.getElementById('themeToggle').addEventListener('click',()=>{
  const root=document.documentElement;
  const next=root.getAttribute('data-theme')==='light'?'dark':'light';
  root.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
  document.getElementById('iconSun').style.display=next==='light'?'none':'block';
  document.getElementById('iconMoon').style.display=next==='light'?'block':'none';
  renderCharts();
});

/* Мобильное меню + скрим */
const menuBtn=document.getElementById('menuToggle');
const scrim=document.getElementById('scrim');
menuBtn.addEventListener('click',()=>{
  const open=document.body.classList.toggle('menu-open');
  menuBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
});
scrim.addEventListener('click', closeMenu);
function closeMenu(){ document.body.classList.remove('menu-open'); menuBtn.setAttribute('aria-expanded','false'); }

/* Плавное появление карточек */
const obs=new IntersectionObserver(es=>es.forEach(e=>{if(e.isIntersecting)e.target.classList.add('reveal')}),{threshold:.12});
document.querySelectorAll('.card').forEach(el=>obs.observe(el));

/* ===== ГРАФИКИ ===== */
const fmt=(n,frac=0)=>new Intl.NumberFormat('ru-RU',{minimumFractionDigits:frac,maximumFractionDigits:frac}).format(n);
const crisp=y=>Math.round(y)+.5;

function svgEl(tag,attrs){const e=document.createElementNS('http://www.w3.org/2000/svg',tag);for(const k in attrs)e.setAttribute(k,attrs[k]);return e;}
function scale(v,a,b,A,B){return A+(v-a)*(B-A)/(b-a);}
function yTicks(min,max,steps=5){const arr=[];for(let i=0;i<=steps;i++)arr.push(min+(max-min)*i/steps);return arr;}

/* мобильный левый отступ побольше, чтобы подписи по Y не резались */
function getPadding(){
  return window.matchMedia('(max-width: 640px)').matches ? 44 : 32;
}

function drawAxes(svg,w,h,p,xLabels,yMin,yMax,formatY){
  const css=getComputedStyle(document.documentElement);
  const gridColor=css.getPropertyValue('--grid').trim();
  const axisColor=css.getPropertyValue('--axis').trim();
  const tickColor=css.getPropertyValue('--tick').trim();
  const tickSize=getComputedStyle(document.documentElement).getPropertyValue('--tick-size').trim();

  const grid=svgEl('g',{stroke:gridColor,'stroke-width':1,'shape-rendering':'crispEdges'});
  const ticks=yTicks(yMin,yMax,5);
  ticks.forEach(t=>{
    const y=crisp(scale(t,yMin,yMax,h-p,p));
    grid.appendChild(svgEl('line',{x1:p,y1:y,x2:w-p,y2:y}));
    const lbl=svgEl('text',{x:p-10,y:y+4,fill:tickColor,'font-size':tickSize,'font-weight':'700','text-anchor':'end'});
    lbl.textContent=formatY?formatY(Math.round(t)):fmt(t,0);
    svg.appendChild(lbl);
  });
  grid.appendChild(svgEl('line',{x1:p,y1:crisp(h-p),x2:w-p,y2:crisp(h-p),stroke:axisColor,'stroke-width':1.25}));
  grid.appendChild(svgEl('line',{x1:crisp(p),y1:p,x2:crisp(p),y2:h-p,stroke:axisColor,'stroke-width':1.25}));
  svg.appendChild(grid);

  const step=(w-2*p)/(xLabels.length-1);
  xLabels.forEach((lab,i)=>{
    const x=p+i*step, y=h-p+18;
    const t=svgEl('text',{x:x,y:y,fill:tickColor,'font-size':'calc(var(--tick-size) - 1px)','font-weight':'700','text-anchor':'middle'});
    t.textContent=lab; svg.appendChild(t);
  });
}

function smoothPath(points){
  let d=`M ${points[0].x} ${points[0].y}`;
  for(let i=1;i<points.length;i++){
    const p=points[i-1], c=points[i];
    const mx=(p.x+c.x)/2, my=(p.y+c.y)/2;
    const pmx=i===1?p.x:(points[i-2].x+c.x)/2, pmy=i===1?p.y:(points[i-2].y+c.y)/2;
    d+=` C ${pmx} ${pmy}, ${mx} ${my}, ${c.x} ${c.y}`;
  }
  return d;
}

function lineChart({svgId,data,labels,color,fill,rev=false,formatY,yMin=null,yMax=null}){
  const svg=document.getElementById(svgId), w=380,h=240,p=getPadding();
  svg.innerHTML='';
  const min=(yMin==null)? Math.min(...data)*0.95 : yMin;
  const max=(yMax==null)? Math.max(...data)*1.05 : yMax;

  drawAxes(svg,w,h,p,labels, rev?Math.max(...data):min, rev?Math.min(...data):max, formatY);

  const pts=data.map((v,i)=>({
    x:scale(i,0,data.length-1,p,w-p),
    y:rev?scale(v,Math.max(...data),Math.min(...data),h-p,p):scale(v,min,max,h-p,p),
    v
  }));

  const base=rev?scale(Math.max(...data),Math.max(...data),Math.min(...data),h-p,p):scale(min,min,max,h-p,p);
  const area=svgEl('path',{fill:fill,stroke:'none',d:`${smoothPath(pts)} L ${w-p} ${base} L ${p} ${base} Z`}); svg.appendChild(area);
  const path=svgEl('path',{d:smoothPath(pts),fill:'none',stroke:color,'stroke-width':3,'shape-rendering':'geometricPrecision'}); svg.appendChild(path);

  const tt=document.getElementById('tt-'+svgId.split('Chart')[0]);
  pts.forEach((pt,i)=>{
    const c=svgEl('circle',{cx:pt.x,cy:pt.y,r:3.2,fill:color,stroke:'none'});
    c.addEventListener('mouseenter',()=>{tt.style.display='block';tt.textContent=`${labels[i]} — ${formatY?formatY(pt.v):fmt(pt.v)}`;});
    c.addEventListener('mousemove',(e)=>{tt.style.left=(e.pageX+12)+'px';tt.style.top=(e.pageY-20)+'px';});
    c.addEventListener('mouseleave',()=>{tt.style.display='none';});
    svg.appendChild(c);
  });
}

function barChart({svgId,data,labels,color,formatY}){
  const svg=document.getElementById(svgId), w=380,h=240,p=getPadding();
  svg.innerHTML='';
  const yMin=0, yMax=Math.max(...data)*1.1;
  drawAxes(svg,w,h,p,labels,yMin,yMax,formatY);
  const gap=8, cw=(w-2*p)/data.length-gap;

  const tickColor=getComputedStyle(document.documentElement).getPropertyValue('--tick').trim();

  data.forEach((v,i)=>{
    const x=p+i*((w-2*p)/data.length)+gap/2;
    const bh=(v/yMax)*(h-2*p);
    const rect=svgEl('rect',{x:x,y:h-p-bh,width:cw,height:bh,rx:6,fill:color});
    svg.appendChild(rect);

    const txt=svgEl('text',{x:x+cw/2,y:h-p-bh-6,fill:tickColor,'font-size':'calc(var(--tick-size) - 1px)','font-weight':'700','text-anchor':'middle'});
    txt.textContent=formatY?formatY(v):fmt(v,0);
    svg.appendChild(txt);
  });
}

/* ДАННЫЕ */
const labelsArr = ['Апр','Май','Июн','Июл','Авг','Сен'];
const leads  = [280, 360, 450, 620, 820, 1100];
const cpl    = [680, 610, 540, 490, 450, 420];
const roi    = [0.6, 0.9, 1.1, 1.5, 1.9, 2.2];
const cr     = [8, 10, 12, 14, 16, 18];

function renderCharts(){
  barChart({svgId:'leadsChart', data:leads, labels:labelsArr, color:'var(--acc)', formatY:v=>fmt(v,0)});
  lineChart({svgId:'cplChart', data:cpl, labels:labelsArr, color:'var(--acc3)', fill:'color-mix(in oklab,var(--acc3) 30%, transparent)', rev:true, formatY:v=>fmt(v,0)+' ₽'});
  lineChart({svgId:'roiChart', data:roi, labels:labelsArr, color:'var(--acc2)', fill:'color-mix(in oklab,var(--acc2) 30%, transparent)', formatY:v=>fmt(v,0)+'×'});
  lineChart({svgId:'crChart', data:cr, labels:labelsArr, color:'var(--acc)', fill:'color-mix(in oklab,var(--acc) 30%, transparent)', yMin:0, yMax:20, formatY:v=>fmt(v,0)+' %'});
}
renderCharts();

/* перерисовать при ресайзе (меняется padding для мобильных) */
window.addEventListener('resize', ()=>renderCharts(), {passive:true});
</script>
</body>
</html>
